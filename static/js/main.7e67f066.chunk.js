(this["webpackJsonpannorxiver-journal-recommender"]=this["webpackJsonpannorxiver-journal-recommender"]||[]).push([[0],[,,,,,,,,,,,function(e,t,n){},,function(e,t,n){e.exports=n(24)},,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(7),l=n(1);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=r.a.createElement("style",null,"\n    #logo:hover #star,\n    #logo[data-spin] #star {\n      animation: star_rotate 2s ease forwards infinite;\n    }\n    @keyframes star_rotate {\n      from {\n        transform: rotate(0);\n      }\n      to {\n        transform: rotate(360deg);\n      }\n    }\n  "),u=r.a.createElement("path",{id:"book_filling",fill:"#ffe0b2",d:"       M 10 50       L 50 70       L 90 50       L 90 35       L 50 55       L 10 35       A 10 10 0 0 0 10 50       M 10 65       L 50 85       L 90 65       L 90 50       L 50 70       L 10 50       A 10 10 0 0 0 10 65     "}),m=r.a.createElement("path",{id:"book_top_cover",fill:"#000000",stroke:"#000000",strokeWidth:5,strokeLinecap:"round",strokeLinejoin:"round",d:"       M 50 15       L 90 35       L 50 55       L 10 35       z     "}),d=r.a.createElement("path",{id:"book_outlines",fill:"none",stroke:"#000000",strokeWidth:5,strokeLinecap:"round",strokeLinejoin:"round",d:"       M 10 50       L 30 60       M 47.5 68.75       L 50 70       L 90 50       M 10 65       L 50 85       L 90 65       M 10 35       A 10 10 0 0 0 10 50       A 10 10 0 0 0 10 65     "}),p=r.a.createElement("path",{id:"bookmark",fill:"#000000",stroke:"#000000",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",d:"       M 35 55       L 35 71.25       L 38.75 69.25       L 42.5 74.75       L 42.5 58.75       z     "}),f=r.a.createElement("g",{transform:"translate(50,34) rotate(26.565) skewX(-26.565) scale(0.10)"},r.a.createElement("path",{id:"star",fill:"#ffe0b2",stroke:"#ffe0b2",strokeWidth:20,strokeLinecap:"round",strokeLinejoin:"round",d:"         M 0.000 -100.000         L 29.389 -40.451         L 95.106 -30.902         L 47.553 15.451         L 58.779 80.902         L 0.000 50.000         L -58.779 80.902         L -47.553 15.451         L -95.106 -30.902         L -29.389 -40.451         z       "})),b=function(e){var t=e.svgRef,n=e.title,a=s(e,["svgRef","title"]);return r.a.createElement("svg",o({viewBox:"0 0 100 100",id:"logo",ref:t},a),n?r.a.createElement("title",null,n):null,i,u,m,d,p,f)},h=r.a.forwardRef((function(e,t){return r.a.createElement(b,o({svgRef:t},e))})),E=(n.p,n(18),function(){return r.a.createElement("header",null,r.a.createElement("section",null,r.a.createElement("h1",null,"AnnoRxver"),r.a.createElement("h2",null,"Journal Recommender"),r.a.createElement(h,{className:"logo"})))}),j=n(2),v=n.n(j),g=n(4),O=n(6),w=n(3),L=n(9),y=function(){var e=Object(g.a)(v.a.mark((function e(t){var n,a,r,c,l;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api-journal-rec.greenelab.com/doi/"+t);case 2:return e.next=4,e.sent.json();case 4:return n=e.sent,a=n.journal_neighbors||[],r=n.paper_neighbors||[],c={x:n["2d_coord"].dim1,y:n["2d_coord"].dim2},l=function(e){return e.pmcid=(e.pmcid||e.document||"").replace("PMC","")},a.forEach(l),r.forEach(l),e.abrupt("return",{recommendedJournals:a,relatedPapers:r,coordinates:c});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(g.a)(v.a.mark((function e(t){var n,a,r,c,l,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.recommendedJournals,a=t.relatedPapers,r=Object(L.a)(t,["recommendedJournals","relatedPapers"]),c=[].concat(Object(w.a)(n),Object(w.a)(a)).map((function(e){return e.pmcid})).filter((function(e){return e})),e.next=4,fetch("https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=pmc&tool=AnnoRxivir&email=greenescientist@gmail.com&retmode=json&id="+c.join(","));case 4:return e.next=6,e.sent.json();case 6:return l=e.sent.result,o=function(e){return Object(O.a)(Object(O.a)({},e),l[e.pmcid]||{})},n=n.map(o),a=a.map(o),e.abrupt("return",Object(O.a)({recommendedJournals:n,relatedPapers:a},r));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(e){var t=e.recommendedJournals,n=e.relatedPapers,a=Object(L.a)(e,["recommendedJournals","relatedPapers"]);return t=S(t),n=S(n),Object(O.a)({recommendedJournals:t,relatedPapers:n},a)},S=function(e){var t=e.map((function(e){return e.distance})),n=Math.max.apply(Math,Object(w.a)(t)),a=Math.min.apply(Math,Object(w.a)(t)),r=n-a;return e.sort((function(e,t){return e.distance-t.distance})),e=e.map((function(e,t){return{id:e.pmcid||null,title:e.title||"",authors:(e.authors||[]).map((function(e){return e.name||""})).filter((function(e){return e})).join(", "),journal:(e.fulljournalname||e.journal||"").split("_").join(" "),year:(e.pubdate||"").split(" ")[0]||"",distance:e.distance,strength:(e.distance-a)/r,rank:t+1}}))},P=(n(20),function(e){var t=e.status;return"LOADING"===t?r.a.createElement("section",{className:"center"},r.a.createElement("div",{className:"message loading"},r.a.createElement("i",{className:"fas fa-spinner fa-spin icon"}),r.a.createElement("span",null,"Loading..."))):"ERROR"===t?r.a.createElement("section",{className:"center"},r.a.createElement("div",{className:"error"},r.a.createElement("i",{className:"far fa-times-circle icon"}),r.a.createElement("span",null,"Couldn't get results"))):null}),N=(n(21),function(e){var t=e.status,n=e.setStatus,c=e.setRecommendedJournals,o=e.setRelatedPapers,s=e.setCoordinates,i=Object(a.useState)(_()||"10.1101/833400"),u=Object(l.a)(i,2),m=u[0],d=u[1],p=Object(a.useCallback)((function(e){var t=e.target.value.trim(),n=t.search(/\d/);d(-1!==n?t.substr(n):"")}),[]),f=Object(a.useCallback)(function(){var e=Object(g.a)(v.a.mark((function e(t){var a,r,l,i,u,m=arguments;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=!(m.length>1&&void 0!==m[1])||m[1],n("LOADING"),a&&C(t),e.prev=3,e.t0=x,e.t1=k,e.next=8,y(t);case 8:return e.t2=e.sent,e.next=11,(0,e.t1)(e.t2);case 11:return e.t3=e.sent,e.next=14,(0,e.t0)(e.t3);case 14:r=e.sent,l=r.recommendedJournals,i=r.relatedPapers,u=r.coordinates,c(l),o(i),s(u),n("SUCCESS"),e.next=28;break;case 24:e.prev=24,e.t4=e.catch(3),console.log(e.t4),n("ERROR");case 28:case"end":return e.stop()}}),e,null,[[3,24]])})));return function(t){return e.apply(this,arguments)}}(),[s,c,o,n]),b=Object(a.useCallback)((function(){var e=_();e&&(d(e),f(e,!1))}),[f]);return Object(a.useEffect)((function(){_()&&f(_())}),[f]),Object(a.useEffect)((function(){return window.addEventListener("popstate",b),function(){return window.removeEventListener("popstate",b)}}),[b,f]),r.a.createElement("section",null,r.a.createElement("p",{className:"center"},r.a.createElement("i",null,"Enter the ",r.a.createElement("a",{href:"https://www.biorxiv.org/"},"bioRxiv")," DOI of your preprint")),r.a.createElement("form",{className:"search",onSubmit:function(e){e.preventDefault(),m.trim()&&f(m)}},r.a.createElement("input",{className:"search_input",value:m,onChange:p,type:"text",placeholder:"e.g. 10.1101/833400",disabled:"LOADING"===t}),r.a.createElement("button",{className:"search_button",type:"submit",title:"Search for related papers and journals",disabled:"LOADING"===t},r.a.createElement("i",{className:"fas fa-search"}))))}),_=function(){return new URLSearchParams(window.location.search.substring(1)).get("doi")},C=function(e){var t=window.location.href,n=window.location.href.split(/[?#]/)[0]+"?doi="+e;t!==n&&window.history.pushState(null,null,n)},M=(n(11),function(e){var t=e.recommendedJournals;return r.a.createElement("section",null,r.a.createElement("h3",null,"Recommended Journals"),t.map((function(e,t){var n=e.journal,a=e.rank,c=e.distance,l=e.strength;return r.a.createElement("div",{key:t,className:"card"},r.a.createElement("div",{className:"score",title:"Distance score: "+c,style:{backgroundColor:"#ff9800"+Math.floor(255*(1-l)).toString(16).padStart(2,"0"),borderColor:"#ff9800"}},a),r.a.createElement("div",{className:"details"},r.a.createElement("a",{href:"https://www.google.com/search?q="+n},n)))})))}),R=function(e){var t=e.relatedPapers;return r.a.createElement("section",null,r.a.createElement("h3",null,"Related Papers"),t.map((function(e,t){var n=e.id,a=e.title,c=e.authors,l=e.year,o=e.journal,s=e.rank,i=e.distance,u=e.strength;return r.a.createElement("div",{key:t,className:"card"},r.a.createElement("div",{className:"score",title:"Distance score: "+i,style:{backgroundColor:"#ff9800"+Math.floor(255*(1-u)).toString(16).padStart(2,"0"),borderColor:"#ff9800"}},s),r.a.createElement("div",{className:"details"},r.a.createElement("a",{href:"https://www.ncbi.nlm.nih.gov/pmc/articles/"+n,title:a},a),r.a.createElement("div",{title:c},c),r.a.createElement("div",{title:o+" \xb7 "+l},o," \xb7 ",l)))})))},J=n(28),A=(n(22),"https://raw.githubusercontent.com/greenelab/annorxiver/master/biorxiv/pca_association_experiment/output/word_pca_similarity/figures/pca_XX_cossim_word_cloud.png"),D=function(e){var t=e.coordinates,n=Object(a.useState)([]),c=Object(l.a)(n,2),o=c[0],s=c[1],i=Object(a.useState)(null),u=Object(l.a)(i,2),m=u[0],d=u[1],p=Object(a.useState)(null),f=Object(l.a)(p,2),b=f[0],h=f[1];return Object(a.useEffect)((function(){(function(){var e=Object(g.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=s,e.next=3,fetch("./data/plot.json");case 3:return e.next=5,e.sent.json();case 5:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),r.a.createElement("section",null,r.a.createElement("h3",null,"Map of PubMed Central"),r.a.createElement(G,{selectedPc:b,setSelectedPc:h}),r.a.createElement(B,{cells:o,selectedCell:m,setSelectedCell:d}),t.x&&t.y&&r.a.createElement(W,{coordinates:t}),m&&r.a.createElement(z,{selectedCell:m}))},G=function(e){var t,n,a=e.selectedPc,c=e.setSelectedPc;return r.a.createElement("p",{className:"center"},(t=1,n=50,Array.from({length:n-t},(function(e,n){return t+n}))).map((function(e){return r.a.createElement(X,Object.assign({key:e},{number:e,selectedPc:a,setSelectedPc:c}))})))},I=function(e){return A.replace("XX",String(e).padStart(2,"0"))},X=function(e){var t=e.number,n=e.selectedPc,o=e.setSelectedPc,s=Object(a.useState)(!1),i=Object(l.a)(s,2),u=i[0],m=i[1],d=Object(a.useState)(null),p=Object(l.a)(d,2),f=p[0],b=p[1],h=Object(a.useState)(null),E=Object(l.a)(h,2),j=E[0],v=E[1],g=Object(J.a)(f,j,{placement:"top",modifiers:[{name:"computeStyles",options:{adaptive:!1}},{name:"offset",options:{offset:[0,10]}}]}),O=g.styles,w=g.attributes,L=g.update;return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{ref:b,className:"cloud_button","data-selected":n===t,onClick:function(){return o(t)},onMouseEnter:function(){return m(!0)},onMouseLeave:function(){return m(!1)}},r.a.createElement("img",{src:I(t),title:"Principal component "+t,alt:"Principal component "+t,onLoad:L})),u&&Object(c.createPortal)(r.a.createElement("img",Object.assign({ref:v,src:I(t),className:"cloud_enlarged",title:"Principal component "+t,alt:"Principal component "+t,onLoad:L,style:O.popper},w.popper)),document.body))},B=function(e){var t=e.cells,n=e.selectedCell,c=e.setSelectedCell,o=Object(a.useRef)(),s=Object(a.useState)(""),i=Object(l.a)(s,2),u=i[0],m=i[1],d=Object(a.useMemo)((function(){return t.map((function(e){return e.papers}))}),[t]),p=Object(a.useMemo)((function(){return Math.min.apply(Math,Object(w.a)(d))}),[d]),f=Object(a.useMemo)((function(){return Math.max.apply(Math,Object(w.a)(d))}),[d]),b=Object(a.useMemo)((function(){return f-p}),[p,f]);return Object(a.useEffect)((function(){if(o.current){var e=o.current.getBBox(),t=e.x,n=e.y,a=e.width,r=e.height;m([t,n,a,r].join(" "))}}),[t]),r.a.createElement("svg",{ref:o,viewBox:u||void 0,className:"map"},t.map((function(e,t){return r.a.createElement("rect",{key:t,className:"cell",x:10*e.x-5,y:10*e.y-5,width:10,height:10,"data-selected":e===n,fillOpacity:.25+(e.papers-p)/b*.75,onClick:function(){return c(e)}})})))},W=function(e){var t=e.coordinates;return r.a.createElement("circle",{className:"marker",cx:10*t.x,cy:10*t.y,r:10/3})},z=function(e){var t=e.selectedCell;return r.a.createElement("div",null,r.a.createElement("h4",null,"Papers"),r.a.createElement("p",null,t.papers.toLocaleString()),r.a.createElement("h4",null,"Top Journals"),r.a.createElement("p",null,t.journals.map((function(e,t){var n=e.name,a=e.count;return r.a.createElement("span",{key:t,className:"cell_detail_row"},r.a.createElement("span",null,n),r.a.createElement("span",null,a.toLocaleString()," papers"),r.a.createElement("br",null))}))),r.a.createElement("h4",null,"Top Principal Components"),r.a.createElement("p",null,t.pcs.map((function(e,t){var n=e.name,a=e.score;return r.a.createElement("span",{key:t,className:"cell_detail_row"},r.a.createElement("a",{href:A.replace("XX",n),target:"_blank",rel:"noopener noreferrer"},n),r.a.createElement("span",null,a.toFixed(2)," score"),r.a.createElement("br",null))}))))},F=function(){return r.a.createElement("section",null,r.a.createElement("h3",null,"What does this do?"),r.a.createElement("p",null,"This tool uses a machine learning model trained on 1.7 million"," ",r.a.createElement("a",{href:"https://www.ncbi.nlm.nih.gov/pmc/"},"PubMed Central")," documents to recommend suitable journals based on the textual content of your"," ",r.a.createElement("a",{href:"https://www.biorxiv.org/"},"bioRxiv")," preprint. For information on how this works, see the"," ",r.a.createElement("a",{href:"https://github.com/greenelab/annorxiver-journal-recommender#annorxiver-journal-recommender"},"readme on GitHub"),"."))},U=function(){return r.a.createElement("footer",null,r.a.createElement("section",null,r.a.createElement("p",null,"A project of the ",r.a.createElement("a",{href:"https://greenelab.com/"},"Greene Lab")),r.a.createElement("p",null,r.a.createElement("a",{href:"https://github.com/greenelab/annorxiver_journal_rec_app"},r.a.createElement("i",{className:"fab fa-github icon"}),"View on GitHub"))))},T=(n(23),function(){var e=Object(a.useState)(""),t=Object(l.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)([]),s=Object(l.a)(o,2),i=s[0],u=s[1],m=Object(a.useState)([]),d=Object(l.a)(m,2),p=d[0],f=d[1],b=Object(a.useState)({}),h=Object(l.a)(b,2),j=h[0],v=h[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(E,null),r.a.createElement("main",null,r.a.createElement(N,{status:n,setStatus:c,setRecommendedJournals:u,setRelatedPapers:f,setCoordinates:v}),r.a.createElement(P,{status:n}),"SUCCESS"===n&&r.a.createElement(M,{recommendedJournals:i}),"SUCCESS"===n&&r.a.createElement(R,{relatedPapers:p}),r.a.createElement(D,{coordinates:j}),r.a.createElement(F,null)),r.a.createElement(U,null))});Object(c.render)(r.a.createElement(T,null),document.getElementById("root"))}],[[13,1,2]]]);
//# sourceMappingURL=main.7e67f066.chunk.js.map